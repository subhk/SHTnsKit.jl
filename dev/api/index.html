<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · SHTnsKit.jl</title><meta name="title" content="API Reference · SHTnsKit.jl"/><meta property="og:title" content="API Reference · SHTnsKit.jl"/><meta property="twitter:title" content="API Reference · SHTnsKit.jl"/><meta name="description" content="Documentation for SHTnsKit.jl."/><meta property="og:description" content="Documentation for SHTnsKit.jl."/><meta property="twitter:description" content="Documentation for SHTnsKit.jl."/><meta property="og:url" content="https://subhk.github.io/SHTnsKit.jl/stable/api/"/><meta property="twitter:url" content="https://subhk.github.io/SHTnsKit.jl/stable/api/"/><link rel="canonical" href="https://subhk.github.io/SHTnsKit.jl/stable/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SHTnsKit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../quickstart/">Quick Start</a></li></ul></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../gpu/">GPU Acceleration</a></li><li><a class="tocitem" href="../distributed/">Distributed Computing</a></li><li><a class="tocitem" href="../performance/">Performance Guide</a></li><li><a class="tocitem" href="../performance_tips/">Performance Tips</a></li><li><a class="tocitem" href="../advanced/">Advanced Usage</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li class="is-active"><a class="tocitem" href>API Reference</a><ul class="internal"><li><a class="tocitem" href="#Configuration-Management"><span>Configuration Management</span></a></li><li><a class="tocitem" href="#Scalar-Field-Transforms"><span>Scalar Field Transforms</span></a></li><li><a class="tocitem" href="#Complex-Field-Transforms"><span>Complex Field Transforms</span></a></li><li><a class="tocitem" href="#Vector-Field-Transforms"><span>Vector Field Transforms</span></a></li><li><a class="tocitem" href="#QST-Transforms-(3D-Vector-Fields)"><span>QST Transforms (3D Vector Fields)</span></a></li><li><a class="tocitem" href="#Rotations"><span>Rotations</span></a></li><li><a class="tocitem" href="#Energy/Power-Spectrum-Analysis"><span>Energy/Power Spectrum Analysis</span></a></li><li><a class="tocitem" href="#Threading-Control"><span>Threading Control</span></a></li><li><a class="tocitem" href="#Buffer-Helpers"><span>Buffer Helpers</span></a></li><li><a class="tocitem" href="#Distributed-Transforms-(MPI)"><span>Distributed Transforms (MPI)</span></a></li><li><a class="tocitem" href="#Gradient-and-Differential-Operators"><span>Gradient and Differential Operators</span></a></li><li><a class="tocitem" href="#Usage-Examples"><span>Usage Examples</span></a></li><li><a class="tocitem" href="#Error-Handling"><span>Error Handling</span></a></li></ul></li><li><a class="tocitem" href="../examples/">Examples Gallery</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/subhk/SHTnsKit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/subhk/SHTnsKit.jl/blob/main/docs/src/api/index.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><div style="background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%); color: white; padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem;">
    <h2 style="margin: 0 0 0.5rem 0; color: white; border: none;">API Reference</h2>
    <p style="margin: 0; opacity: 0.9;">Complete function and type documentation</p>
</div><p>Complete reference for all SHTnsKit.jl functions and types.</p><h2 id="Configuration-Management"><a class="docs-heading-anchor" href="#Configuration-Management">Configuration Management</a><a id="Configuration-Management-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration-Management" title="Permalink"></a></h2><h3 id="Configuration-Creation"><a class="docs-heading-anchor" href="#Configuration-Creation">Configuration Creation</a><a id="Configuration-Creation-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration-Creation" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SHTnsKit.create_config"><a class="docstring-binding" href="#SHTnsKit.create_config"><code>SHTnsKit.create_config</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">create_config(lmax::Int; mmax=lmax, mres=1, nlat=lmax+2, nlon=max(2*lmax+1,4),
               norm::Symbol=:orthonormal, cs_phase::Bool=true,
               real_norm::Bool=false, robert_form::Bool=false,
               grid_type::Symbol=:gauss) -&gt; SHTConfig</code></pre><p>Compatibility wrapper for configuration creation used in some docs/snippets. Supports Gauss–Legendre (<code>grid_type = :gauss</code>) and regular equiangular (<code>grid_type = :regular</code> or <code>:regular_poles</code>) grids, forwarding to the appropriate creator. <code>nlat</code>/<code>nlon</code> defaults are adjusted to satisfy accuracy constraints for the chosen grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/config.jl#L771-L782">source</a></section><section><div><pre><code class="language-julia hljs">create_config(::Type{T}, lmax::Int, nlat::Int, mres::Int=1; kwargs...) -&gt; SHTConfig</code></pre><p>Compatibility method that ignores the element type <code>T</code> and calls <code>create_config</code>. Provided to match older example signatures like <code>create_config(Float64, 20, 22, 1)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/config.jl#L807-L812">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.create_gauss_config"><a class="docstring-binding" href="#SHTnsKit.create_gauss_config"><code>SHTnsKit.create_gauss_config</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">create_gauss_config(lmax::Int, nlat::Int; mmax::Int=lmax, nlon::Int=max(2*lmax+1, 4)) -&gt; SHTConfig</code></pre><p>Create a Gauss–Legendre based SHT configuration. Constraints:</p><ul><li><code>nlat ≥ lmax+1</code> for exactness up to <code>lmax</code> in θ integration.</li><li><code>nlon ≥ 2*mmax+1</code> to resolve azimuthal orders up to <code>mmax</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/config.jl#L142-L148">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.create_regular_config"><a class="docstring-binding" href="#SHTnsKit.create_regular_config"><code>SHTnsKit.create_regular_config</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">create_regular_config(lmax::Int, nlat::Int; mmax::Int=lmax, mres::Int=1,
                      nlon::Int=max(2*lmax+1, 4), norm::Symbol=:orthonormal,
                      cs_phase::Bool=true, real_norm::Bool=false,
                      robert_form::Bool=false, include_poles::Bool=false,
                      precompute_plm::Bool=true, use_dh_weights::Bool=false) -&gt; SHTConfig</code></pre><p>Create an equiangular (regular) grid configuration. Regular grids use simple <code>θ = (i+0.5)π/nlat</code> nodes by default; set <code>include_poles=true</code> to place nodes directly on the poles. By default associated Legendre tables are precomputed, which mirrors SHTns&#39; regular-grid behaviour and improves performance.</p><p><strong>Driscoll-Healy Quadrature</strong></p><p>Set <code>use_dh_weights=true</code> to use Driscoll-Healy quadrature for exact spherical harmonic transforms. This requires:</p><ul><li><code>include_poles=true</code></li><li><code>nlat = 2*(lmax+1)</code> for exactness up to degree lmax</li><li><code>nlat</code> must be even</li></ul><p>The DH grid uses θ = πj/n for j=0,...,n-1 (includes north pole, excludes south pole) and provides exact quadrature via specially computed weights.</p><p>Reference: Driscoll &amp; Healy (1994), &quot;Computing Fourier transforms and convolutions on the 2-sphere&quot;, Adv. Appl. Math., 15, 202-250.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/config.jl#L661-L686">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.destroy_config"><a class="docstring-binding" href="#SHTnsKit.destroy_config"><code>SHTnsKit.destroy_config</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">destroy_config(cfg::SHTConfig)</code></pre><p>No-op placeholder for API symmetry with libraries that require explicit teardown.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/config.jl#L878-L882">source</a></section></details></article><h3 id="Index-Utilities"><a class="docs-heading-anchor" href="#Index-Utilities">Index Utilities</a><a id="Index-Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Index-Utilities" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SHTnsKit.nlm_calc"><a class="docstring-binding" href="#SHTnsKit.nlm_calc"><code>SHTnsKit.nlm_calc</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">nlm_calc(lmax::Integer, mmax::Integer, mres::Integer) -&gt; Int</code></pre><p>Calculate the total number of packed spectral coefficients for a real scalar field. Real fields only need m ≥ 0 modes due to Hermitian symmetry: Y<em>l^{-m} = (-1)^m (Y</em>l^m)*</p><p>The packing scheme groups modes by m-order, then by l-degree within each m block. This layout is optimized for vectorized operations and cache efficiency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/layout.jl#L79-L87">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.LM_index"><a class="docstring-binding" href="#SHTnsKit.LM_index"><code>SHTnsKit.LM_index</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">LM_index(lmax::Int, mres::Int, l::Int, m::Int) -&gt; Int</code></pre><p>Convert 2D spherical harmonic indices (l,m) to a 1D packed array index. This implements the SHTns packing convention for efficient memory layout.</p><p>The packing scheme groups coefficients by m-order blocks, with each block containing all valid l-degrees for that m. This enables vectorized operations on modes with the same azimuthal symmetry.</p><p>Matches SHTns C macro: LM(shtns, l, m)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/layout.jl#L130-L141">source</a></section></details></article><h2 id="Scalar-Field-Transforms"><a class="docs-heading-anchor" href="#Scalar-Field-Transforms">Scalar Field Transforms</a><a id="Scalar-Field-Transforms-1"></a><a class="docs-heading-anchor-permalink" href="#Scalar-Field-Transforms" title="Permalink"></a></h2><h3 id="Forward-Transform-(Synthesis)"><a class="docs-heading-anchor" href="#Forward-Transform-(Synthesis)">Forward Transform (Synthesis)</a><a id="Forward-Transform-(Synthesis)-1"></a><a class="docs-heading-anchor-permalink" href="#Forward-Transform-(Synthesis)" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SHTnsKit.synthesis"><a class="docstring-binding" href="#SHTnsKit.synthesis"><code>SHTnsKit.synthesis</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">synthesis(cfg::SHTConfig, alm::AbstractMatrix; real_output::Bool=true) -&gt; Matrix</code></pre><p>Inverse transform back to a grid <code>(nlat, nlon)</code>. If <code>real_output=true</code>, Hermitian symmetry is enforced before IFFT. Optional <code>fft_scratch</code> lets you reuse a preallocated <code>(nlat,nlon)</code> complex buffer for lower allocations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/core_transforms.jl#L314-L320">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.synthesis!"><a class="docstring-binding" href="#SHTnsKit.synthesis!"><code>SHTnsKit.synthesis!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">synthesis!(plan::SHTPlan, f_out::AbstractMatrix, alm::AbstractMatrix; real_output=true)</code></pre><p>In-place inverse scalar SHT writing spatial field into <code>f_out</code>. Streams m→k directly without building a (θ×m) intermediate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/plan.jl#L471-L476">source</a></section><section><div><pre><code class="language-julia hljs">synthesis!(cfg::SHTConfig, f_out::AbstractMatrix, alm::AbstractMatrix;
           real_output::Bool=true, use_fused_loops::Bool=true)</code></pre><p>In-place inverse transform. Writes the spatial field into <code>f_out</code> to reduce allocations. <code>f_out</code> must be <code>(nlat, nlon)</code> and real if <code>real_output=true</code>. You may pass a complex <code>fft_scratch</code> buffer of size <code>(nlat,nlon)</code> to reuse FFT workspace.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/core_transforms.jl#L329-L337">source</a></section></details></article><h3 id="Backward-Transform-(Analysis)"><a class="docs-heading-anchor" href="#Backward-Transform-(Analysis)">Backward Transform (Analysis)</a><a id="Backward-Transform-(Analysis)-1"></a><a class="docs-heading-anchor-permalink" href="#Backward-Transform-(Analysis)" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SHTnsKit.analysis"><a class="docstring-binding" href="#SHTnsKit.analysis"><code>SHTnsKit.analysis</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">analysis(cfg::SHTConfig, f::AbstractMatrix) -&gt; Matrix{ComplexF64}</code></pre><p>Forward transform on Gauss–Legendre × equiangular grid. Returns coefficients <code>alm[l+1, m+1]</code> with orthonormal normalization.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/core_transforms.jl#L111-L116">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.analysis!"><a class="docstring-binding" href="#SHTnsKit.analysis!"><code>SHTnsKit.analysis!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">analysis!(plan::SHTPlan, alm_out::AbstractMatrix, f::AbstractMatrix)</code></pre><p>In-place forward scalar SHT writing coefficients into <code>alm_out</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/plan.jl#L424-L428">source</a></section><section><div><pre><code class="language-julia hljs">analysis!(cfg::SHTConfig, alm_out::AbstractMatrix, f::AbstractMatrix; use_fused_loops=true)</code></pre><p>In-place forward transform. Writes coefficients into <code>alm_out</code> to avoid allocating the output matrix each call. <code>alm_out</code> must be size <code>(lmax+1, mmax+1)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/core_transforms.jl#L125-L130">source</a></section></details></article><h2 id="Complex-Field-Transforms"><a class="docs-heading-anchor" href="#Complex-Field-Transforms">Complex Field Transforms</a><a id="Complex-Field-Transforms-1"></a><a class="docs-heading-anchor-permalink" href="#Complex-Field-Transforms" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SHTnsKit.SH_to_spat_cplx"><a class="docstring-binding" href="#SHTnsKit.SH_to_spat_cplx"><code>SHTnsKit.SH_to_spat_cplx</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SH_to_spat_cplx(cfg::SHTConfig, alm_packed::AbstractVector{&lt;:Complex}) -&gt; Matrix{ComplexF64}</code></pre><p>Synthesize complex spatial field from packed complex coefficients (LM_cplx order). Returns an <code>nlat × nlon</code> complex array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/complex_packed.jl#L85-L90">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.spat_cplx_to_SH"><a class="docstring-binding" href="#SHTnsKit.spat_cplx_to_SH"><code>SHTnsKit.spat_cplx_to_SH</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">spat_cplx_to_SH(cfg::SHTConfig, z::AbstractMatrix{&lt;:Complex}) -&gt; Vector{ComplexF64}</code></pre><p>Analyze complex spatial field into packed complex coefficients (LM_cplx order). Input <code>z</code> must be <code>nlat × nlon</code> complex.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/complex_packed.jl#L139-L144">source</a></section></details></article><h2 id="Vector-Field-Transforms"><a class="docs-heading-anchor" href="#Vector-Field-Transforms">Vector Field Transforms</a><a id="Vector-Field-Transforms-1"></a><a class="docs-heading-anchor-permalink" href="#Vector-Field-Transforms" title="Permalink"></a></h2><p>Vector fields on the sphere are decomposed into <strong>spheroidal</strong> and <strong>toroidal</strong> components:</p><ul><li><strong>Spheroidal</strong>: Poloidal component (has radial component)</li><li><strong>Toroidal</strong>: Azimuthal component (purely horizontal)</li></ul><h3 id="Vector-Synthesis"><a class="docs-heading-anchor" href="#Vector-Synthesis">Vector Synthesis</a><a id="Vector-Synthesis-1"></a><a class="docs-heading-anchor-permalink" href="#Vector-Synthesis" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SHTnsKit.SHsphtor_to_spat"><a class="docstring-binding" href="#SHTnsKit.SHsphtor_to_spat"><code>SHTnsKit.SHsphtor_to_spat</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SHsphtor_to_spat(cfg, Slm, Tlm; real_output=true) -&gt; (Vt, Vp)</code></pre><p>Transform spheroidal/toroidal coefficients to horizontal vector field components. Returns colatitude (Vt) and azimuthal (Vp) components on the spatial grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/sphtor_transforms.jl#L178-L183">source</a></section></details></article><h3 id="Vector-Analysis"><a class="docs-heading-anchor" href="#Vector-Analysis">Vector Analysis</a><a id="Vector-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Vector-Analysis" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SHTnsKit.spat_to_SHsphtor"><a class="docstring-binding" href="#SHTnsKit.spat_to_SHsphtor"><code>SHTnsKit.spat_to_SHsphtor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">spat_to_SHsphtor(cfg, Vt, Vp) -&gt; (Slm, Tlm)</code></pre><p>Transform horizontal vector field components to spheroidal/toroidal coefficients. Input: colatitude (Vt) and azimuthal (Vp) components on spatial grid. The returned coefficients satisfy δ<em>lm = −l(l+1) S</em>lm (divergence) and ζ<em>lm = −l(l+1) T</em>lm (vorticity) when expressed in the internal normalization.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/sphtor_transforms.jl#L305-L312">source</a></section></details></article><h2 id="QST-Transforms-(3D-Vector-Fields)"><a class="docs-heading-anchor" href="#QST-Transforms-(3D-Vector-Fields)">QST Transforms (3D Vector Fields)</a><a id="QST-Transforms-(3D-Vector-Fields)-1"></a><a class="docs-heading-anchor-permalink" href="#QST-Transforms-(3D-Vector-Fields)" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SHTnsKit.SHqst_to_spat"><a class="docstring-binding" href="#SHTnsKit.SHqst_to_spat"><code>SHTnsKit.SHqst_to_spat</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SHqst_to_spat(cfg, Qlm, Slm, Tlm; real_output=true) -&gt; (Vr, Vt, Vp)</code></pre><p>Transform QST spectral coefficients to 3D spatial vector field components. Returns radial (Vr), colatitude (Vt), and azimuthal (Vp) components.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/qst_transforms.jl#L95-L100">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.spat_to_SHqst"><a class="docstring-binding" href="#SHTnsKit.spat_to_SHqst"><code>SHTnsKit.spat_to_SHqst</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">spat_to_SHqst(cfg, Vr, Vt, Vp) -&gt; (Qlm, Slm, Tlm)</code></pre><p>Transform 3D spatial vector field to QST spectral coefficients. Input: radial (Vr), colatitude (Vt), and azimuthal (Vp) components.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/qst_transforms.jl#L115-L120">source</a></section></details></article><h2 id="Rotations"><a class="docs-heading-anchor" href="#Rotations">Rotations</a><a id="Rotations-1"></a><a class="docs-heading-anchor-permalink" href="#Rotations" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SHTnsKit.SH_Zrotate"><a class="docstring-binding" href="#SHTnsKit.SH_Zrotate"><code>SHTnsKit.SH_Zrotate</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SH_Zrotate(cfg::SHTConfig, Qlm::AbstractVector{&lt;:Complex}, alpha::Real, Rlm::AbstractVector{&lt;:Complex})</code></pre><p>Rotate a real-field SH expansion around the Z-axis by angle <code>alpha</code>. Input and output are packed <code>Qlm</code> vectors (LM order, m ≥ 0). In-place supported if <code>Rlm === Qlm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/rotations.jl#L95-L100">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.SH_Yrotate"><a class="docstring-binding" href="#SHTnsKit.SH_Yrotate"><code>SHTnsKit.SH_Yrotate</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SH_Yrotate(cfg::SHTConfig, Qlm::AbstractVector{&lt;:Complex}, alpha::Real, Rlm::AbstractVector{&lt;:Complex})</code></pre><p>Rotate a real-field SH expansion around the Y-axis by angle <code>alpha</code>. Uses Wigner-d mixing per l; dispatches to the general rotation engine.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/rotations.jl#L137-L142">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.SH_Yrotate90"><a class="docstring-binding" href="#SHTnsKit.SH_Yrotate90"><code>SHTnsKit.SH_Yrotate90</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SH_Yrotate90(cfg::SHTConfig, Qlm::AbstractVector{&lt;:Complex}, Rlm::AbstractVector{&lt;:Complex})</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/rotations.jl#L149-L151">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.SH_Xrotate90"><a class="docstring-binding" href="#SHTnsKit.SH_Xrotate90"><code>SHTnsKit.SH_Xrotate90</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SH_Xrotate90(cfg::SHTConfig, Qlm::AbstractVector{&lt;:Complex}, Rlm::AbstractVector{&lt;:Complex})</code></pre><p>Rotate around X-axis by 90 degrees using ZYZ equivalence: Rz(π/2)·Ry(π/2)·Rz(-π/2).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/rotations.jl#L156-L160">source</a></section></details></article><h2 id="Energy/Power-Spectrum-Analysis"><a class="docs-heading-anchor" href="#Energy/Power-Spectrum-Analysis">Energy/Power Spectrum Analysis</a><a id="Energy/Power-Spectrum-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Energy/Power-Spectrum-Analysis" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SHTnsKit.energy_scalar_l_spectrum"><a class="docstring-binding" href="#SHTnsKit.energy_scalar_l_spectrum"><code>SHTnsKit.energy_scalar_l_spectrum</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">energy_scalar_l_spectrum(cfg, alm; real_field=true) -&gt; Vector{Float64}</code></pre><p>Compute energy spectrum as a function of spherical harmonic degree l. Returns E(l) = Σₘ |a_lm|² for each l = 0..lmax.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/spectral_diagnostics.jl#L74-L79">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.energy_vector_l_spectrum"><a class="docstring-binding" href="#SHTnsKit.energy_vector_l_spectrum"><code>SHTnsKit.energy_vector_l_spectrum</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">energy_vector_l_spectrum(cfg, Slm, Tlm; real_field=true) -&gt; Vector{Float64}</code></pre><p>Compute kinetic energy spectrum by degree l for vector fields. Returns KE(l) = Σₘ l(l+1)[|S<em>lm|² + |T</em>lm|²] for each l = 1..lmax.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/spectral_diagnostics.jl#L108-L113">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.energy_scalar"><a class="docstring-binding" href="#SHTnsKit.energy_scalar"><code>SHTnsKit.energy_scalar</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">energy_scalar(cfg, alm; real_field=true) -&gt; Float64</code></pre><p>Compute the total energy of a scalar field from its spherical harmonic coefficients.</p><p>For a scalar field f(θ,φ) = Σ a<em>lm Y</em>l^m(θ,φ), the energy is defined as: E = (1/2) ∫ |f|² dΩ = (1/2) Σ |a_lm|²</p><p>This represents the L² norm of the field, which is conserved under orthonormal spherical harmonic transforms (Parseval&#39;s identity).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/energy_diagnostics.jl#L76-L86">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.energy_vector"><a class="docstring-binding" href="#SHTnsKit.energy_vector"><code>SHTnsKit.energy_vector</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">energy_vector(cfg, Slm, Tlm; real_field=true) -&gt; Float64</code></pre><p>Compute the total kinetic energy of a vector field from spheroidal/toroidal coefficients.</p><p>For a vector field V = ∇×(T Y<em>l^m êᵣ) + ∇ₕ(S Y</em>l^m), the kinetic energy is: KE = (1/2) ∫ |V|² dΩ = (1/2) Σ [l(l+1)|S<em>lm|² + l(l+1)|T</em>lm|²]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/energy_diagnostics.jl#L98-L105">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.enstrophy"><a class="docstring-binding" href="#SHTnsKit.enstrophy"><code>SHTnsKit.enstrophy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">enstrophy(cfg, Tlm; real_field=true) -&gt; Float64</code></pre><p>Compute the enstrophy (kinetic energy of vorticity) from toroidal coefficients.</p><p>For a toroidal field with coefficients T<em>lm, the enstrophy is: Z = (1/2) ∫ |∇×V|² dΩ = (1/2) Σ l²(l+1)²|T</em>lm|²</p><p>This is a measure of the small-scale intensity of rotational motion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/vorticity_diagnostics.jl#L14-L23">source</a></section></details></article><h2 id="Threading-Control"><a class="docs-heading-anchor" href="#Threading-Control">Threading Control</a><a id="Threading-Control-1"></a><a class="docs-heading-anchor-permalink" href="#Threading-Control" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SHTnsKit.shtns_use_threads"><a class="docstring-binding" href="#SHTnsKit.shtns_use_threads"><code>SHTnsKit.shtns_use_threads</code></a> — <span class="docstring-category">Function</span></summary><section><div><p>shtns<em>use</em>threads(num_threads) -&gt; Int</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/api_compat.jl#L239">source</a></section></details></article><h2 id="Buffer-Helpers"><a class="docs-heading-anchor" href="#Buffer-Helpers">Buffer Helpers</a><a id="Buffer-Helpers-1"></a><a class="docs-heading-anchor-permalink" href="#Buffer-Helpers" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SHTnsKit.scratch_spatial"><a class="docstring-binding" href="#SHTnsKit.scratch_spatial"><code>SHTnsKit.scratch_spatial</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">scratch_spatial(cfg::SHTConfig, T::Type=Float64) -&gt; Matrix{T}</code></pre><p>Allocate a spatial grid buffer of size <code>(nlat, nlon)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/buffer_utils.jl#L106-L110">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.scratch_fft"><a class="docstring-binding" href="#SHTnsKit.scratch_fft"><code>SHTnsKit.scratch_fft</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">scratch_fft(cfg::SHTConfig, T::Type=ComplexF64) -&gt; Matrix{T}</code></pre><p>Allocate a complex buffer sized for φ-FFTs <code>(nlat, nlon)</code>. Reuse this across <code>analysis!</code>/<code>synthesis!</code> calls via the <code>fft_scratch</code> keyword to avoid per-call allocations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/buffer_utils.jl#L113-L119">source</a></section></details></article><h2 id="Distributed-Transforms-(MPI)"><a class="docs-heading-anchor" href="#Distributed-Transforms-(MPI)">Distributed Transforms (MPI)</a><a id="Distributed-Transforms-(MPI)-1"></a><a class="docs-heading-anchor-permalink" href="#Distributed-Transforms-(MPI)" title="Permalink"></a></h2><p>When using MPI with PencilArrays, the following functions are available via the parallel extension:</p><ul><li><code>dist_analysis(cfg, fθφ)</code> - Distributed spatial to spectral transform</li><li><code>dist_synthesis(cfg, Alm; prototype_θφ, real_output)</code> - Distributed spectral to spatial transform</li><li><code>dist_spat_to_SHsphtor(cfg, Vθ, Vφ)</code> - Distributed vector analysis</li><li><code>dist_SHsphtor_to_spat(cfg, Slm, Tlm; prototype_θφ)</code> - Distributed vector synthesis</li></ul><p>See the <a href="../distributed/">Distributed Guide</a> for detailed usage.</p><h2 id="Gradient-and-Differential-Operators"><a class="docs-heading-anchor" href="#Gradient-and-Differential-Operators">Gradient and Differential Operators</a><a id="Gradient-and-Differential-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Gradient-and-Differential-Operators" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SHTnsKit.SH_to_grad_spat"><a class="docstring-binding" href="#SHTnsKit.SH_to_grad_spat"><code>SHTnsKit.SH_to_grad_spat</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SH_to_grad_spat(cfg::SHTConfig, Slm::AbstractMatrix; real_output::Bool=true)</code></pre><p>Gradient synthesis alias for compatibility with SHTns.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/sphtor_transforms.jl#L756-L760">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.divergence_from_spheroidal"><a class="docstring-binding" href="#SHTnsKit.divergence_from_spheroidal"><code>SHTnsKit.divergence_from_spheroidal</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">divergence_from_spheroidal(cfg, Slm) -&gt; Matrix</code></pre><p>Return divergence spectral coefficients δ<em>lm corresponding to spheroidal modes via δ</em>lm = −l(l+1) S<em>lm (`δ</em>{00} = 0`).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/sphtor_transforms.jl#L466-L471">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SHTnsKit.vorticity_from_toroidal"><a class="docstring-binding" href="#SHTnsKit.vorticity_from_toroidal"><code>SHTnsKit.vorticity_from_toroidal</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">vorticity_from_toroidal(cfg, Tlm) -&gt; Matrix</code></pre><p>Return vorticity spectral coefficients ζ<em>lm = −l(l+1) T</em>lm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/subhk/SHTnsKit.jl/blob/13987c2464c3c9eaeb1ea07ddec7af4579b5a89e/src/sphtor_transforms.jl#L510-L514">source</a></section></details></article><h2 id="Usage-Examples"><a class="docs-heading-anchor" href="#Usage-Examples">Usage Examples</a><a id="Usage-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-Examples" title="Permalink"></a></h2><h3 id="Basic-Transform"><a class="docs-heading-anchor" href="#Basic-Transform">Basic Transform</a><a id="Basic-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Transform" title="Permalink"></a></h3><pre><code class="language-julia hljs">using SHTnsKit

lmax = 16
nlat = lmax + 2
nlon = 2*lmax + 1
cfg = create_gauss_config(lmax, nlat; nlon=nlon)

# Create test pattern
spatial = zeros(cfg.nlat, cfg.nlon)
for i in 1:cfg.nlat
    x = cfg.x[i]
    spatial[i, :] .= (3*x^2 - 1)/2
end

# Transform roundtrip
Alm = analysis(cfg, spatial)
recovered = synthesis(cfg, Alm)

destroy_config(cfg)</code></pre><h3 id="Vector-Field-Transform"><a class="docs-heading-anchor" href="#Vector-Field-Transform">Vector Field Transform</a><a id="Vector-Field-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Vector-Field-Transform" title="Permalink"></a></h3><pre><code class="language-julia hljs">using SHTnsKit

lmax = 32
nlat = lmax + 2
nlon = 2*lmax + 1
cfg = create_gauss_config(lmax, nlat; nlon=nlon)

# Create velocity field
Vθ = zeros(cfg.nlat, cfg.nlon)
Vφ = zeros(cfg.nlat, cfg.nlon)
for i in 1:cfg.nlat, j in 1:cfg.nlon
    θ = cfg.θ[i]
    φ = cfg.φ[j]
    Vθ[i,j] = cos(θ) * sin(φ)
    Vφ[i,j] = cos(φ)
end

# Decompose into spheroidal/toroidal
Slm, Tlm = spat_to_SHsphtor(cfg, Vθ, Vφ)

# Reconstruct
Vθ_rec, Vφ_rec = SHsphtor_to_spat(cfg, Slm, Tlm)

destroy_config(cfg)</code></pre><h2 id="Error-Handling"><a class="docs-heading-anchor" href="#Error-Handling">Error Handling</a><a id="Error-Handling-1"></a><a class="docs-heading-anchor-permalink" href="#Error-Handling" title="Permalink"></a></h2><h3 id="Common-Errors"><a class="docs-heading-anchor" href="#Common-Errors">Common Errors</a><a id="Common-Errors-1"></a><a class="docs-heading-anchor-permalink" href="#Common-Errors" title="Permalink"></a></h3><ul><li><strong><code>BoundsError</code></strong>: Invalid lmax/mmax values</li><li><strong><code>AssertionError</code> / <code>DimensionMismatch</code></strong>: Array size mismatches</li></ul><h3 id="Best-Practices"><a class="docs-heading-anchor" href="#Best-Practices">Best Practices</a><a id="Best-Practices-1"></a><a class="docs-heading-anchor-permalink" href="#Best-Practices" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Always check array sizes
@assert size(Alm) == (cfg.lmax+1, cfg.mmax+1) &quot;Wrong spectral array size&quot;
@assert size(spatial) == (cfg.nlat, cfg.nlon) &quot;Wrong spatial array size&quot;

# Always destroy configurations
cfg = create_gauss_config(32, 34; nlon=65)
# ... work with cfg ...
destroy_config(cfg)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../advanced/">« Advanced Usage</a><a class="docs-footer-nextpage" href="../examples/">Examples Gallery »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 1 February 2026 11:29">Sunday 1 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
